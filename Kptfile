apiVersion: kpt.dev/v1alpha1
kind: Kptfile
metadata:
  name: crunchy-data-postgres-operator
upstream:
  type: git
  git:
    commit: 9901ef18100d2cfc0f08191cab27b4ab4670cd67
    repo: sso://team/abox-team/abox
    directory: /dev/demo/postgres/application
    ref: master
openAPI:
  definitions:
    io.k8s.cli.setters.backrest-storage-class:
      description: the storage class used for storage provisioning(e.g. standard,
        gold, fast).
      type: string
      x-k8s-cli:
        setter:
          name: backrest-storage-class
          value: standard
    io.k8s.cli.setters.backrest-storage-size:
      description: the size of the Persistant Volume Claim(PVC) for backrest storage.
        Must use a Kuberentes resource value, e.g. 20Gi, 20G, 12e6.
      pattern: (\+)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))(Ki|Mi|Gi|Ti|Pi|Ei|m|""|K|M|G|T|P|E|((e|E)(\+|-)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))))
      type: string
      x-k8s-cli:
        setter:
          name: backrest-storage-size
          value: 300M
    io.k8s.cli.setters.cluster-name:
      description: PostgreSQL cluster name
      type: string
      x-k8s-cli:
        setter:
          name: cluster-name
          value: postgres
    io.k8s.cli.setters.db-user:
      description: database username
      type: string
      x-k8s-cli:
        setter:
          name: db-user
          value: testuser
    io.k8s.cli.setters.enable-metrics:
      description: set true to set up metrics collection.
      pattern: (true|false)
      type: string
      x-k8s-cli:
        setter:
          name: enable-metrics
          value: "true"
    io.k8s.cli.setters.enable-pgbadger:
      description: set to true to enable pgBadger capabilities on all newly created
        clusters.
      pattern: (true|false)
      type: string
      x-k8s-cli:
        setter:
          name: enable-pgbadger
          value: "true"
    io.k8s.cli.setters.name:
      description: application name
      type: string
      x-k8s-cli:
        setter:
          name: name
          value: postgres-operator
    io.k8s.cli.setters.namespace:
      type: string
      x-k8s-cli:
        setter:
          name: namespace
          value: pgo
    io.k8s.cli.setters.primary-storage-class:
      description: the storage class used for storage provisioning(e.g. standard,
        gold, fast).
      type: string
      x-k8s-cli:
        setter:
          name: primary-storage-class
          value: standard
    io.k8s.cli.setters.primary-storage-size:
      description: the size of the Persistant Volume Claim(PVC) for primary storage.
        Must use a Kuberentes resource value, e.g. 20Gi, 20g, 12e6.
      pattern: (\+)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))(Ki|Mi|Gi|Ti|Pi|Ei|m|""|K|M|G|T|P|E|((e|E)(\+|-)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))))
      type: string
      x-k8s-cli:
        setter:
          name: primary-storage-size
          value: 300M
    io.k8s.cli.setters.replica-storage-class:
      description: the storage class used for storage provisioning(e.g. standard,
        gold, fast).
      type: string
      x-k8s-cli:
        setter:
          name: replica-storage-class
          value: standard
    io.k8s.cli.setters.replica-storage-size:
      description: the size of the Persistant Volume Claim(PVC) for replica storage.
        Must use a Kuberentes resource value, e.g. 20Gi, 20g, 12e6.
      pattern: (\+)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))(Ki|Mi|Gi|Ti|Pi|Ei|m|""|K|M|G|T|P|E|((e|E)(\+|-)?(([0-9]+(\.)?[0-9]*)|(\.[0-9]+))))
      type: string
      x-k8s-cli:
        setter:
          name: replica-storage-size
          value: 300M
    io.k8s.cli.setters.replicas:
      description: number of database replication
      pattern: ^[0-9]+$
      type: string
      x-k8s-cli:
        setter:
          name: replicas
          value: "1"
    io.k8s.cli.substitutions.backrest-repo-config-name:
      x-k8s-cli:
        substitution:
          name: backrest-repo-config-name
          pattern: ${cluster-name}-backrest-repo-config
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.ca-secret-name:
      x-k8s-cli:
        substitution:
          name: ca-secret-name
          pattern: ${cluster-name}-ca
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.collect-secret-name:
      x-k8s-cli:
        substitution:
          name: collect-secret-name
          pattern: ${cluster-name}-collect-secret
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.postgres-secret-name:
      x-k8s-cli:
        substitution:
          name: postgres-secret-name
          pattern: ${cluster-name}-postgres-secret
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.primaryuser-secret-name:
      x-k8s-cli:
        substitution:
          name: primaryuser-secret-name
          pattern: ${cluster-name}-primaryuser-secret
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.replication-cert-name:
      x-k8s-cli:
        substitution:
          name: replication-cert-name
          pattern: ${cluster-name}-replication-cert
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.server-cert-name:
      x-k8s-cli:
        substitution:
          name: server-cert-name
          pattern: ${cluster-name}-server-cert
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
    io.k8s.cli.substitutions.testuser-secret-name:
      x-k8s-cli:
        substitution:
          name: testuser-secret-name
          pattern: ${cluster-name}-testuser-secret
          values:
          - marker: ${cluster-name}
            ref: '#/definitions/io.k8s.cli.setters.cluster-name'
